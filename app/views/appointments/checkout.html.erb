<div class = "page-header">

  <h1>
    <%= t :step2 %>
    <small>checkout</small>
  </h1>

</div>

<%= form_for(@appointment, :url => {action: 'create_appointment'}) do |f| %>
    <% if @appointment.errors.any? %>
        <div id="error_explanation">
          <h2><%= pluralize(@appointment.errors.count, "erro") %> impediram este agendamento de ser salvo:</h2>

          <ul>
            <% @appointment.errors.full_messages.each do |message| %>
                <li><%= message %></li>
            <% end %>
          </ul>
        </div>
    <% end %>

  <%= f.hidden_field(:provider_id) %>
  <%= f.hidden_field(:companies_service_id) %>
  <%= f.hidden_field(:start) %>
  <%= f.hidden_field(:price) %>


    <% if !@appointment.provider.blank? %>
        <h4>
          <strong><%= f.label :provider_id %>:</strong>
          <%= @appointment.provider.name %>
        </h4>
    <% end %>

    <h4>
      <strong><%= f.label :companies_service_id %>:</strong>
      <%= @appointment.companies_service.service.name %>
    </h4>

    <h4>
      <strong><%= f.label :start %>:</strong>
      <%= l @appointment.start, format: :long   %>
    </h4>

    <h4>
      <strong><%= f.label :duration %>:</strong>
      <%= formatted_duration @appointment.companies_service.duration %>
    </h4>

    <% if !@appointment.price.blank? %>
        <h4>
          <strong><%= f.label :price %>:</strong>
          <%= @appointment.price %>
        </h4>
    <% end %>


    <%= f.fields_for :client, @appointment.client ||= Client.new do |client_fields| %>
      <div class="form-group">
        <%= client_fields.label :email %>
        <%= client_fields.text_field :email, :class => 'form-control' %>
      </div>

      <div class="form-group">
        <%= client_fields.label :name %>
        <%= client_fields.text_field :name, :class => 'form-control' %>
      </div>

      <div class="form-group">
        <%= client_fields.label :phone %>
        <%= client_fields.text_field :phone, :class => 'form-control' %>
      </div>
    <% end %>

    <div class="form-group">
      <%= f.label :obs %><br>
      <%= f.text_area :obs, :class => 'form-control' %>
    </div>


    <div class="actions">
      <%= link_to t(:back), @appointment.companies_service.company, class: 'btn btn-primary' %>
      <%= f.submit t(:schedule), :class => 'btn btn-success' %>
    </div>
<% end %>